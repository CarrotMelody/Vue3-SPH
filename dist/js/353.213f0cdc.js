"use strict";(self["webpackChunkapp"]=self["webpackChunkapp"]||[]).push([[353],{2353:function(e,a,t){t.r(a),t.d(a,{default:function(){return J}});var s=t(3396),c=t(7139);const l=e=>((0,s.dD)("data-v-5e455256"),e=e(),(0,s.Cn)(),e),i={class:"cart"},r=l((()=>(0,s._)("h4",null,"全部商品",-1))),d={class:"cart-main"},n=(0,s.uE)('<div class="cart-th" data-v-5e455256><div class="cart-th1" data-v-5e455256>全部</div><div class="cart-th2" data-v-5e455256>商品</div><div class="cart-th3" data-v-5e455256>单价（元）</div><div class="cart-th4" data-v-5e455256>数量</div><div class="cart-th5" data-v-5e455256>小计（元）</div><div class="cart-th6" data-v-5e455256>操作</div></div>',1),u={class:"cart-body"},h={class:"cart-list-con1"},o=["checked","onChange"],k={class:"cart-list-con2"},v=["src"],C={class:"item-msg"},p={class:"cart-list-con4"},m={class:"price"},_={class:"cart-list-con5"},g=["onClick"],y=["value","onChange"],f=["onClick"],w={class:"cart-list-con6"},I={class:"sum"},b={class:"cart-list-con7"},A=["onClick"],L=l((()=>(0,s._)("br",null,null,-1))),N=l((()=>(0,s._)("a",{href:"#none"},"移到收藏",-1))),x={class:"cart-tool"},F={class:"select-all"},P=["checked"],T=l((()=>(0,s._)("span",null,"全选",-1))),U={class:"option"},z=l((()=>(0,s._)("a",{href:"#none"},"移到我的关注",-1))),B=l((()=>(0,s._)("a",{href:"#none"},"清除下柜商品",-1))),D={class:"money-box"},j=l((()=>(0,s._)("div",{class:"chosed"},[(0,s.Uk)("已选择 "),(0,s._)("span",null,"0"),(0,s.Uk)("件商品")],-1))),S={class:"sumprice"},E=l((()=>(0,s._)("em",null,"总价（不含运费） ：",-1))),q={class:"summoney"},H={class:"sumbtn"},K=(0,s.Uk)("结算");function O(e,a,t,l,O,R){const W=(0,s.up)("router-link");return(0,s.wg)(),(0,s.iD)("div",i,[r,(0,s._)("div",d,[n,(0,s._)("div",u,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(l.cartInfoList,(e=>((0,s.wg)(),(0,s.iD)("ul",{class:"cart-list",key:e.id},[(0,s._)("li",h,[(0,s._)("input",{type:"checkbox",name:"chk_list",checked:1==e.isChecked,onChange:a=>l.updateChecked(e,a)},null,40,o)]),(0,s._)("li",k,[(0,s._)("img",{src:e.imgUrl},null,8,v),(0,s._)("div",C,(0,c.zw)(e.skuName),1)]),(0,s._)("li",p,[(0,s._)("span",m,(0,c.zw)(e.skuPrice),1)]),(0,s._)("li",_,[(0,s._)("a",{href:"javascript:void(0)",class:"mins",onClick:a=>l.handler("minor",-1,e)},"-",8,g),(0,s._)("input",{autocomplete:"off",type:"text",value:e.skuNum,minnum:"1",class:"itxt",onChange:a=>l.handler("change",1*a.target.value,e)},null,40,y),(0,s._)("a",{href:"javascript:void(0)",class:"plus",onClick:a=>l.handler("add",1,e)},"+",8,f)]),(0,s._)("li",w,[(0,s._)("span",I,(0,c.zw)(e.skuNum*e.skuPrice),1)]),(0,s._)("li",b,[(0,s._)("a",{href:"#none",class:"sindelet",onClick:a=>l.deleteCartById(e.skuId)},"删除",8,A),L,N])])))),128))])]),(0,s._)("div",x,[(0,s._)("div",F,[(0,s._)("input",{class:"chooseAll",type:"checkbox",checked:l.isAllChecked&&l.cartInfoList.length,onChange:a[0]||(a[0]=(...e)=>l.updateAllCartChecked&&l.updateAllCartChecked(...e))},null,40,P),T]),(0,s._)("div",U,[(0,s._)("a",{onClick:a[1]||(a[1]=(...e)=>l.deleteAllCheckedCart&&l.deleteAllCheckedCart(...e))},"删除选中的商品"),z,B]),(0,s._)("div",D,[j,(0,s._)("div",S,[E,(0,s._)("i",q,(0,c.zw)(l.totalPrice),1)]),(0,s._)("div",H,[(0,s.Wm)(W,{class:"sum-btn",to:"/trade"},{default:(0,s.w5)((()=>[K])),_:1})])])])])}var R=t(4870),W=t(65),Y={name:"ShopCart",setup(){const e=(0,W.oR)(),a=(0,R.qj)({throttleTimer:!1}),t=()=>{e.dispatch("getCartList")};(0,s.bv)((()=>{t()}));const c=(e,t)=>{a.throttleTimer||(a.throttleTimer=!0,setTimeout((()=>{e(),a.throttleTimer=!1}),t))},l=(a,s,l)=>{c((async()=>{switch(a){case"add":s=1;break;case"minor":s=l.skuNum>1?-1:0;break;case"change":s=isNaN(s)||s<1?0:parseInt(s)-l.skuNum;break}try{await e.dispatch("addOrUpdateShopCar",{skuId:l.skuId,skuNum:s}),t()}catch(c){alert(c.message)}}),500)},i=async a=>{try{await e.dispatch("deleteCartListBySkuId",a),t()}catch(s){alert(s.message)}},r=async(a,s)=>{try{let c=s.target.value?"1":"0";await e.dispatch("updateCheckedById",{skuId:a.skuId,isChecked:c}),t()}catch(c){alert(c.message)}},d=async()=>{try{await e.dispatch("deleteAllCheckedCart"),t()}catch(a){alert(a.message)}},n=async a=>{try{let s=a.target.checked?"1":"0";await e.dispatch("updateAllCartIsChecked",s),t()}catch(s){alert(s.message)}},u=(0,s.Fl)((()=>e.getters.cartList.cartInfoList||[]));return{handler:l,deleteCartById:i,updateChecked:r,deleteAllCheckedCart:d,updateAllCartChecked:n,cartList:(0,s.Fl)((()=>e.getters.cartList||[])),cartInfoList:(0,s.Fl)((()=>u.value||[])),totalPrice:(0,s.Fl)({get:()=>{let e=0;return u.value.forEach((a=>{e+=a.skuNum*a.skuPrice})),e}}),isAllChecked:(0,s.Fl)({get:()=>u.value.every((e=>1==e.isChecked))})}}},Z=t(89);const G=(0,Z.Z)(Y,[["render",O],["__scopeId","data-v-5e455256"]]);var J=G}}]);